matrix:
  include:
  - os: osx
    osx_image: xcode10.2
    language: node_js
    node_js: '10'
    env:
    - ELECTRON_CACHE=$HOME/.cache/electron
    - ELECTRON_BUILDER_CACHE=$HOME/.cache/electron-builder
  - os: linux
    services: docker
    language: generic
cache:
  directories:
  - node_modules
  - "$HOME/.cache/electron"
  - "$HOME/.cache/electron-builder"
script:
- |
  if [ "$TRAVIS_OS_NAME" == "linux" ]; then
    docker run --rm \
      -v ${PWD}:/project \
      -v ~/.cache/electron:/root/.cache/electron \
      -v ~/.cache/electron-builder:/root/.cache/electron-builder \
      electronuserland/builder:wine \
      /bin/bash -c "npm run dist -- --win"
  else
    npm run dist -- --mac
  fi
before_cache:
- rm -rf $HOME/.cache/electron-builder/wine
branches:
  except:
  - "/^v\\d+\\.\\d+\\.\\d+$/"
deploy:
  provider: releases
  api_key:
    secure: B/S0BdEPvqkyitxi/f5iXDYrFZdhK7cJjQfsJESOm0HuE1D21FQq7x48pcfZSvSkgbs9G4ioYnNaXmK4BkPWTjuD4hAp52zpuN4jOSR2MlSHmuTwAVPwPhH0CRL0Neep5jRoBohQrIaUA2sE2/4uXA15q8JGt1mk44o8b49GQ/Sp6gxpEl34QV/XSfFobVWuNXq94TgE8byrWUiqy3/UanzezKAhHdqiU/rSYtjlbtAt1NCZ6Ft2IT8GwAJuwGJfiV+MR9v7LglREQEit5Sx02NswlbIQkawLkQWT1YQtMnFdbnK8SXAUxGOPtkDd3PErcXDUv3cqSNkcTEW+beg4OdBkIc3O+Pb7QYAlLsgm9Z39rWEfVO8N1w4PN0pznTjcWCAs6rn83PPD/Y4R17XH0lDgPqEFZ+BtNcHtd1LKHP7aOZpWNgfxJxiHSLGParKTVsWnI3jSpKLeHVxFTnuwDhJfpbp1FyogYMuBVVJT/fnDuXNEKUThu7QpkV1PUxkVB3Iw2XoJ3IBtnZOMJ1J9ZPj/SED7JgAW6LBo6crHdZk3oncHzAcsinZqmYTbP1K62K9HqswhVPorEG1J0QATxPtICnayjmKm71Z/HeMzpJdu4hLodZ2UjeRZLmxsDv5I3eCVCP/Z+ebCDusgrjmB7AP2UgUDloV97T6cNWs8u0=
  file: dist/*
  skip_cleanup: true
  on:
    repo: phuwasit/electron-svelte
    tags: true
